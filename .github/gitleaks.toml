# Gitleaks configuration for Nix projects (v2.4.0 compatible)
title = "Gitleaks configuration for Nix projects"
version = "2.4.0"

# Enable default rules
[extend]
useDefault = true

# Custom rules for Nix
[[rules]]
description = "Hardcoded Nix store path"
regex = "/nix/store/[a-z0-9]+(-[a-z0-9]+)*"

[[rules]]
description = "Potential API key in Nix expression"
regex = "(api[_-]?key|apikey|api_key|api-key)[=:][ \t]*(['\"]?[a-zA-Z0-9]{16,}['\"]?)"

[[rules]]
description = "Potential secret in Nix expression"
regex = "(password|passwd|pwd|secret|token|key)[=:][ \t]*(['\"]?[a-zA-Z0-9]{12,}['\"]?)"

# Exclude common false positives
[allowlist]
description = "Common false positives in Nix projects"
files = [
  "**/*.lock",
  "**/result-*"
]

[[allowlist.path]]
value = ".devenv/**"

[[allowlist.path]]
value = ".direnv/**"

[[allowlist.path]]
value = ".git/**"

# Note: Scan behavior is now configured in the workflow file
