# Gitleaks configuration for Nix projects
title = "Gitleaks configuration for Nix projects"
version = "8.24.3"

# Enable default rules
[extend]
useDefault = true

# Custom rules for Nix
[[rules]]
description = "Hardcoded Nix store path"
regex = "/nix/store/[a-z0-9]+(-[a-z0-9]+)*"

[[rules]]
description = "Potential API key in Nix expression"
regex = "(api[_-]?key|apikey|api_key|api-key)[=:][ \t]*(['\"]?[a-zA-Z0-9]{16,}['\"]?)"

[[rules]]
description = "Potential secret in Nix expression"
regex = "(password|passwd|pwd|secret|token|key)[=:][ \t]*(['\"]?[a-zA-Z0-9]{12,}['\"]?)"

# Exclude common false positives
[allowlist]
description = "Common false positives in Nix projects"
files = [
  "**/*.lock",
  "**/result-*"
]

[[allowlist.path]]
value = ".devenv/**"

[[allowlist.path]]
value = ".direnv/**"

[[allowlist.path]]
value = ".git/**"

# Configure scanning behavior
[scan]
# Scan all files in the repository
scan-type = "all"
# Report findings but don't fail the build
exit-code = 0
